#!/bin/bash

## La Popa Ã©s Nuestra !
## Script developed for atorresbr (( atorresbr@gmail.com ))

#this functio send the error mesage to user if his not use the sudo command
if [ "$(whoami)" != "root" ]
then
  echo
    echo -e " ğŸ”´ use the sudo command to run this script "
    sleep 1
    echo
    echo -e " ğŸ”´ use el comando sudo para usar el script "
    sleep 1
    echo
    echo -e " ğŸ”´ use o comando sudo para rodar o script de instalaÃ§Ã£o "
  echo
  exit 1
fi

echo
echo

on_yellow='\033[43m'  # Yellow
on_green='\033[42m'   # Green
b_yellow='\033[1;33m' # Bold Yellow
b_black='\033[1;30m'  # Boldblack
b_green='\033[1;32m'  # Bold Green
green='\033[0;32m'    # Light Green
red='\033[0;31m'      # Red
nc='\033[0m'          # No Color

sleep 2

clear

echo -ne ${b_green}

echo -e "
   * * * =============================================== * * * 
 *        ğŸ‡ªğŸ‡¸   Executando los Comandos de Shell                *
   * * * =============================================== * * *
"
sleep 2
clear

echo -e "
   * * * =============================================== * * * 
 *        ğŸ‡§ğŸ‡·   Executando os Comandos de Shell                 *
   * * * =============================================== * * *
"

sleep 2
clear

echo -e "
   * * * =============================================== * * * 
 *        ğŸ‡ºğŸ‡¸     Executing the Shell commmands                 *
   * * * =============================================== * * *
"

echo -e "
                                                                   __ 
 _____ _____ _____ _____    _____ _____ _____ ____  _____ _____   |  |
|   __|     |  _  |  _  |  |   __|  _  |  _  |    \|   __|   __|  |  |
|__   |  |  |   __|     |  |__   |   __|     |  |  |   __|__   |  |__|
|_____|_____|__|  |__|__|  |_____|__|  |__|__|____/|_____|_____|  |__|
                                                                      
"

echo
echo

## informando sobre a instalaÃ§Ã£o

echo -ne ${b_green}

sleep 2
echo -e "
   * * * =============================================== * * * 
 *       ğŸ‡ªğŸ‡¸ Este script instalarÃ¡ Sopa Spades en tu PC ğŸœ      *
   * * * =============================================== * * *
"
sleep 2
echo -e "
   * * * =============================================== * * * 
 *     ğŸ‡ºğŸ‡¸ This scrip will isntall Sopa Spades on you PC ğŸœ     *
   * * * =============================================== * * *
"

sleep 2
echo -e "
   * * * =============================================== * * * 
 *   ğŸ‡§ğŸ‡· Este script irÃ¡ instalar o Sopa Spades em seu PC ğŸœ    *
   * * * =============================================== * * *
"

echo
echo

## sleep 2
## echo -e " ğŸ‡ªğŸ‡¸ Este script instalarÃ¡ Sopa Spades en tu PC ğŸœ "

## echo
## sleep 2
## echo -e  " ğŸ‡ºğŸ‡¸ This scrip will isntall Sopa Spades on you PC ğŸœ "

## echo
## sleep 2
## echo -e " ğŸ‡§ğŸ‡· Este script irÃ¡ instalar o Sopa Spades em seu PC ğŸœ "

## echo

echo
sleep 2
echo -e " ğŸ‡ªğŸ‡¸ Eliminando el directorio antiguo para reinstalar el juego âœ…"

echo
sleep 2
echo -e " ğŸ‡ºğŸ‡¸ Removing the old directory to reinstall the Game âœ…"

echo 
sleep 2
echo -e " ğŸ‡§ğŸ‡· Removendo o antigo diretÃ³rio para reinstalar o Jogo âœ… "

echo
echo 

echo -ne ${b_yellow}

sleep 2
echo -e " sudo rm -rf /usr/local/share/games/openspades "

sleep 2

echo
echo -e " && "
echo

sleep 2
echo -e " sudo rm -rf /usr/local/share/games/sopaspades "

echo -ne ${nc}

echo

sleep 1
echo -ne ${b_green}'ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©    (33%)\r '
sleep 1
echo -ne 'ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©    (66%)\r '
sleep 1
echo -ne 'ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©    (100%)\r ' ${nc}
echo -ne '\n'
sleep 2

echo -ne ${b_yellow}

echo
echo -e " ÃŠxito !"
echo

echo -ne ${nc}

# These commands run as sudo (root)
rm -rf /usr/local/games/openspades 2>/dev/null
rm -rf /usr/local/games/sopaspades 2>/dev/null
rm -rf /usr/local/share/games/openspades 2>/dev/null
rm -rf /usr/local/share/games/sopaspades 2>/dev/null
rm -rf /usr/share/applications/openspades.desktop 2>/dev/null
rm -rf /usr/share/applications/sopaspades.desktop 2>/dev/null
rm -rf /usr/share/pixmaps/openspades.xpm 2>/dev/null
rm -rf /usr/share/pixmaps/sopaspades.xpm 2>/dev/null
rm -rf /usr/games/openspades 2>/dev/null
rm -rf /usr/games/sopaspades 2>/dev/null

  # Clean cache files
  rm -rf /home/*/.cache/icon-cache.kcache && \
  rm -rf /home/*/.cache/thumbnails/* && \
  rm -rf /home/*/.cache/icons/* && \

sleep 2
# Replace line 165:

# With this:
if dpkg -l | grep -q openspades; then
  echo " OPENSPADES was installed, removing it ğŸ—‘ï¸ "
  sudo apt purge openspades -y
else
  echo " OpenSpades or SynSpades are not here ğŸ˜¬ "
fi && \

echo
echo

#echo -e " it's not a error ğŸ™Œ ğŸ‘† "

echo
echo

## informando sobre as dependÃªncias

echo
sleep 2

echo -ne ${b_green}

echo -e " ğŸ‡ªğŸ‡¸ Instalando las dependencias "

echo
sleep 2

echo -e " ğŸ‡ºğŸ‡¸ Installing the dependencies "

echo
sleep 2

echo -e " ğŸ‡§ğŸ‡· Instalando as dependÃªncias "

echo
echo

sleep 1

echo -ne ${b_green}

echo " sudo apt-get install "

echo -ne ${b_yellow}

   echo
   echo    " ğŸº pkg-config libglew-dev "
sleep 1
   echo
   echo    " ğŸº libcurl3-openssl-dev " 
sleep 1
   echo
   echo    " ğŸº libsdl2-dev "
sleep 1
   echo
   echo    " ğŸº libsdl2-image-dev "
sleep 1
   echo
   echo    " ğŸ˜‹ libalut-dev "
sleep 1
   echo
   echo    " ğŸº xdg-utils libfreetype6-dev "
sleep 1
   echo
   echo    " ğŸº libopus-dev "
sleep 1
   echo
   echo    " ğŸº libopusfile-dev "
sleep 1
   echo
   echo    " ğŸº cmake imagemagick "
sleep 1
   echo
   echo    " ğŸº libjpeg-dev "
sleep 1
   echo
   echo    " ğŸ˜‹ ğŸ™ libxinerama-dev "
sleep 1
   echo
   echo    " ğŸ™ libxft-dev "
sleep 1

echo
echo

sleep 1
echo -ne ${b_green}'ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©    (33%)\r '
sleep 1
echo -ne 'ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©    (66%)\r '
sleep 1
echo -ne 'ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©    (100%)\r '
echo -ne '\n'
sleep 2

echo -ne ${b_yellow}

echo
echo -e " ÃŠxito !"
echo

sleep 1

## dependencias 

echo -ne ${b_yellow}

sudo apt-get install build-essential pkg-config libglew-dev libcurl4-openssl-dev libsdl2-dev \
  libsdl2-image-dev libalut-dev xdg-utils libfreetype6-dev libopus-dev \
   imagemagick zip unzip libopusfile-dev cmake\
  libjpeg-dev libxinerama-dev libxft-dev && \



echo
echo

echo -ne ${b_green}

## informando e Clonando os repositÃ³rios

sleep 2
echo -e " ğŸ‡ªğŸ‡¸ Clonando el repositorio y instalando "

echo
sleep 2

echo -e " ğŸ‡ºğŸ‡¸ Cloning the repository and installing "

echo
sleep 2

echo -e " ğŸ‡§ğŸ‡· Clonando o repositÃ³rio e instalando "

echo
sleep 2

echo -ne ${b_yellow}

echo -e " sudo rm -Rf sopaspades && sudo rm -Rf openspades "
sleep 1

echo
echo -e " && "
echo

sleep 1
echo -e " git clone https://github.com/atorresbr/sopaspades.git && cd sopaspades "

echo
echo

sleep 1
echo -ne ${b_green}'ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©    (33%)\r '
sleep 1
echo -ne 'ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©    (66%)\r '
sleep 1
echo -ne 'ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©    (100%)\r ' ${nc}
echo -ne '\n'
sleep 2

echo -ne ${b_yellow}

echo
echo -e " ÃŠxito !"
echo

sleep 2

  sudo rm -Rf sopaspades && sudo rm -Rf openspades && sudo rm -Rf a-la-popa &&
  git clone https://github.com/atorresbr/sopaspades.git &&
  cd sopaspades && \

echo
echo   

sleep 2

echo -ne ${b_green}

echo -e " ğŸ‡ªğŸ‡¸ instalando"

echo
sleep 2

echo -e " ğŸ‡ºğŸ‡¸ installing"

echo
sleep 2

echo -e " ğŸ‡§ğŸ‡· instalando"

echo
sleep 2

echo -ne ${b_yellow}

echo -e " mkdir sopaspades.mk && cd sopaspades.mk && "
sleep 1
echo -e " cmake .. -DCMAKE_BUILD_TYPE=RelWithDebInfo && "
sleep 1
echo -e " make && sudo make install "
sleep 1

echo
echo

sleep 1
echo -ne ${b_green}'ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©    (33%)\r '
sleep 1
echo -ne 'ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©    (66%)\r '
sleep 1
echo -ne 'ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©    (100%)\r ' ${nc}
echo -ne '\n'
sleep 2

echo -ne ${b_yellow}

echo
echo -e " ÃŠxito !"
echo

# Fix the icon after installation
echo -ne ${b_green}
echo -e " ğŸ‡§ğŸ‡· Corrigindo o Ã­cone do jogo"
echo -e " ğŸ‡ºğŸ‡¸ Fixing game icon"
echo -e " ğŸ‡ªğŸ‡¸ Arreglando el icono del juego"
echo -ne ${b_yellow}

# Get the correct path to the icon
ICON_PATH=$(find /home -name "sopaspades.png" -path "*/snap/gui/sopaspades.png" 2>/dev/null | head -n 1)

if [ -f "$ICON_PATH" ]; then
  # Copy custom icon to system locations
  sudo cp "$ICON_PATH" /usr/share/pixmaps/sopaspades.xpm
  sudo mkdir -p /usr/local/share/games/sopaspades/Resources/Icons/hicolor/256x256/apps/
  sudo cp "$ICON_PATH" /usr/local/share/games/sopaspades/Resources/Icons/hicolor/256x256/apps/sopaspades.png
  sudo mkdir -p /usr/local/share/games/sopaspades/Resources/Icons/hicolor/48x48/apps/
  sudo cp "$ICON_PATH" /usr/local/share/games/sopaspades/Resources/Icons/hicolor/48x48/apps/sopaspades.png
  
  # Fix desktop file
  if [ -f "/usr/share/applications/sopaspades.desktop" ]; then
    sudo sed -i 's/Icon=.*/Icon=sopaspades/' /usr/share/applications/sopaspades.desktop
  fi
  
  echo "Icon copied successfully!"
else
  echo "Icon file not found! Please check the path to your icon file."
fi

# Update icon cache
sudo update-desktop-database /usr/share/applications 2>/dev/null || true
sudo gtk-update-icon-cache -f -t /usr/share/icons/hicolor 2>/dev/null || true

echo -e " ÃŠxito !"

sleep 1

   mkdir sopaspades.mk && sudo chmod +x sopaspades.mk &&
   cd sopaspades.mk && cmake .. -DCMAKE_BUILD_TYPE=RelWithDebInfo && make -j$(nproc) &&
   sudo make install
   
echo
echo

echo -ne ${b_green}

sleep 1

echo -e " ğŸ‡ªğŸ‡¸ comenzando el Juego "

echo
sleep 1
echo -e " ğŸ‡ºğŸ‡¸ starting the Game "

echo
sleep 1
echo -e " ğŸ‡§ğŸ‡· iniciando o Jogo "

echo
sleep 1

  echo
  echo

  echo -e " ğŸ˜˜ ğŸ‡ªğŸ‡¸ Comparte este script ! "

  echo
  sleep 1

  echo -e " ğŸ˜˜ ğŸ‡ºğŸ‡¸ Share this Script ! "

  echo
  sleep 1

  echo -e " ğŸ˜˜ ğŸ‡§ğŸ‡· Compartilhe este Script ! "

  echo

  echo
  echo

echo " sopaspades ğŸ”« " 

## cd $REPO_DIRECTORY a-la-popa/sopaspades.mk; bin/openspades
## cd ~/sopaspades/sopaspades.mk; bin/sopaspades

echo
echo 

